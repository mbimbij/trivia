<app-go-back-button></app-go-back-button>
<ng-container *ngIf="(game$ | async) as game; else loadingOrError">
  <ng-container *ngIf="(userService.getUser() | async) as user">

    <table>
      <!--  TODO factoriser cette table avec celle de game-list en un seul composant-->
      <tr>
        <th>id</th>
        <th>game</th>
        <th>creator</th>
        <th>players</th>
        <th>status</th>
        <th>join</th>
        <th>start</th>
        <th>go to</th>
      </tr>
      <tr [ngClass]="'game-row'">
        <td class="id">{{ game.id }}</td>
        <td class="name">{{ game.name }}</td>
        <td class="creator-name">{{ game.creator.name }}</td>
        <td class="players-names">{{ game.players | objectAttribute: 'name' }}</td>
        <td class="state">{{ game.state }}</td>
        <td class="join">
          <app-join-game-button [user]="user"
                                  [gameId]="game.id"
                                  [playersNames]="game.getPlayersNames()"
                                  [canJoin]="game.canJoin(user)"
                                  [isPlayerInGame]="game.isPlayer(user)"
                                  [isGameStarted]="game.isStarted()"
          />
        </td>
        <td class="start">
          <app-start-game-button [gameId]="game.id" [userId]="user.id" [canStart]="game.canStart(user)"/>
        </td>
        <td class="goto">
          <app-goto-game-button [gameId]="gameId" [userId]="user.id" [canGoto]="game.canGoto(user)"/>
        </td>
      </tr>
    </table>
  </ng-container>
</ng-container>

<ng-template #loadingOrError>
  <app-error-display [gameId]="gameId" [gameLoadingError$]="gameLoadingError$"></app-error-display>
</ng-template>
{{ checkRender() }}
